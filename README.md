# xlkit

<p align="center">
  <img src="./logo.png" alt="xlkit Logo" width="200" />
</p>

[ExcelJS](https://github.com/exceljs/exceljs) ã®ãŸã‚ã®å®£è¨€çš„ã‚¹ã‚­ãƒ¼ãƒžãƒ™ãƒ¼ã‚¹ãƒ©ãƒƒãƒ‘ãƒ¼ã§ã™ã€‚
ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¹ã‚­ãƒ¼ãƒžã§Excelã®æ§‹é€ ã‚’å®šç¾©ã™ã‚‹ã ã‘ã§ã€ã‚¹ã‚¿ã‚¤ãƒ«ã€ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’xlkitãŒè‡ªå‹•ã§å‡¦ç†ã—ã¾ã™ã€‚

[English README](./README_en.md)

## ç›®æ¬¡

- [ç‰¹å¾´](#ç‰¹å¾´)
- [ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](#ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«)
- [ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ](#ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ)
- [ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](#ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹)
  - [ã‚¹ã‚¿ã‚¤ãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä¸€è¦§](#ã‚¹ã‚¿ã‚¤ãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä¸€è¦§)
  - [ç½«ç·šãƒ—ãƒªã‚»ãƒƒãƒˆ](#ç½«ç·šãƒ—ãƒªã‚»ãƒƒãƒˆ)
  - [ã‚¹ã‚¿ã‚¤ãƒ«å„ªå…ˆé †ä½](#ã‚¹ã‚¿ã‚¤ãƒ«å„ªå…ˆé †ä½)
  - [å…ˆé ­ã‚¼ãƒ­ãƒ»æ–‡å­—åˆ—ã®ä¿æŒ](#å…ˆé ­ã‚¼ãƒ­æ–‡å­—åˆ—ã®ä¿æŒ)
- [APIãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](#apiãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹)
- [è¤‡æ•°è¡Œãƒ˜ãƒƒãƒ€ãƒ¼](#è¤‡æ•°è¡Œãƒ˜ãƒƒãƒ€ãƒ¼)
- [ã‚ˆãã‚ã‚‹ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³](#ã‚ˆãã‚ã‚‹ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³)
- [å®Œå…¨ãªä¾‹](#å®Œå…¨ãªä¾‹)

## ç‰¹å¾´

- ðŸ“ **å®£è¨€çš„ã‚¹ã‚­ãƒ¼ãƒž**: ãƒ‡ãƒ¼ã‚¿ã¨ã‚¹ã‚­ãƒ¼ãƒžã‚’ä¸€ç®‡æ‰€ã§å®šç¾©
- ðŸŽ¨ **æŸ”è»Ÿãªã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š**: ã‚¿ã‚¤ãƒˆãƒ«ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã€è¡Œã€åˆ—ã€ã‚»ãƒ«ã®7æ®µéšŽã§ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨å¯èƒ½
- ðŸ”— **è‡ªå‹•çµåˆ**: åŒã˜å€¤ã‚’æŒã¤ç¸¦æ–¹å‘ã®ã‚»ãƒ«ã‚’è‡ªå‹•çš„ã«çµåˆ
- ðŸ“Š **è¤‡æ•°è¡Œãƒ˜ãƒƒãƒ€ãƒ¼**: `colSpan`/`rowSpan` ã«ã‚ˆã‚‹æŸ”è»Ÿãªãƒ˜ãƒƒãƒ€ãƒ¼ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
- ðŸ“ **è‡ªå‹•åˆ—å¹…**: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆå…¨è§’æ–‡å­—ã‚’å«ã‚€ï¼‰ã«åŸºã¥ã„ã¦åˆ—å¹…ã‚’ã‚¹ãƒžãƒ¼ãƒˆã«è¨ˆç®—
- ðŸŒˆ **Hexã‚«ãƒ©ãƒ¼**: æ¨™æº–çš„ãª6æ¡ã®Hexã‚³ãƒ¼ãƒ‰ï¼ˆ`#FF0000`ï¼‰ã‚’ç›´æŽ¥ä½¿ç”¨å¯èƒ½
- ðŸŒ **ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«**: Node.jsï¼ˆãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ï¼‰ã¨ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆ`Uint8Array` å‡ºåŠ›ï¼‰ã®ä¸¡æ–¹ã§å‹•ä½œ

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install xlkit
```

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```typescript
import { createWorkbook } from 'xlkit';

await createWorkbook().addSheet({
  name: 'Users',
  headers: [
    { key: 'id', label: 'ID', width: 10 },
    { key: 'name', label: 'æ°å', width: 20 },
    { key: 'role', label: 'å½¹å‰²', width: 'auto', merge: 'vertical' },
    {
      key: 'isActive',
      label: 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹',
      format: (val) => val ? 'æœ‰åŠ¹' : 'ç„¡åŠ¹',
      style: (val) => ({ font: { color: val ? '#00AA00' : '#FF0000' } })
    }
  ],
  rows: [
    { id: 1, name: 'Alice', role: 'Admin', isActive: true },
    { id: 2, name: 'Bob', role: 'User', isActive: true },
    { id: 3, name: 'Charlie', role: 'User', isActive: false }
  ],
  borders: 'all'
}).save('users.xlsx');
```

## ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### ã‚¹ã‚¿ã‚¤ãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä¸€è¦§

#### ãƒ•ã‚©ãƒ³ãƒˆ (`font`)

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | åž‹ | å–ã‚Šã†ã‚‹å€¤ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜Ž |
|-----------|-----|-----------|----------|------|
| `name` | `string` | `'Arial'`, `'ãƒ¡ã‚¤ãƒªã‚ª'`, etc. | ã‚·ã‚¹ãƒ†ãƒ ä¾å­˜ | ãƒ•ã‚©ãƒ³ãƒˆå |
| `size` | `number` | `8` - `72` | `11` | ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º |
| `bold` | `boolean` | `true` / `false` | `false` | å¤ªå­— |
| `italic` | `boolean` | `true` / `false` | `false` | æ–œä½“ |
| `underline` | `boolean` | `true` / `false` | `false` | ä¸‹ç·š |
| `strike` | `boolean` | `true` / `false` | `false` | å–ã‚Šæ¶ˆã—ç·š |
| `color` | `string` | `'#RRGGBB'` å½¢å¼ | `'#000000'` | æ–‡å­—è‰² |

```typescript
// ä½¿ç”¨ä¾‹
{ font: { name: 'Arial', size: 12, bold: true, color: '#FF0000' } }
```

#### å¡—ã‚Šã¤ã¶ã— (`fill`)

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | åž‹ | å–ã‚Šã†ã‚‹å€¤ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜Ž |
|-----------|-----|-----------|----------|------|
| `color` | `string` | `'#RRGGBB'` å½¢å¼ | ãªã— | èƒŒæ™¯è‰² |

```typescript
// ä½¿ç”¨ä¾‹
{ fill: { color: '#FFFF00' } }  // é»„è‰²ã®èƒŒæ™¯
```

**ã‚ˆãä½¿ã†è‰²:**

| è‰² | Hexã‚³ãƒ¼ãƒ‰ | ç”¨é€”ä¾‹ |
|----|----------|--------|
| èµ¤ | `#FF0000` | ã‚¨ãƒ©ãƒ¼ã€è­¦å‘Š |
| ç·‘ | `#00AA00` | æˆåŠŸã€æœ‰åŠ¹ |
| é’ | `#4472C4` | ãƒ˜ãƒƒãƒ€ãƒ¼ã€ãƒªãƒ³ã‚¯ |
| é»„ | `#FFFF00` | ãƒã‚¤ãƒ©ã‚¤ãƒˆ |
| ã‚°ãƒ¬ãƒ¼ | `#F2F2F2` | äº¤äº’è¡Œã®èƒŒæ™¯ |
| è–„ã„é’ | `#DEEBF7` | é¸æŠžè¡Œ |
| è–„ã„ç·‘ | `#C6EFCE` | æ­£ã®å€¤ |
| è–„ã„èµ¤ | `#FFC7CE` | è² ã®å€¤ |

#### é…ç½® (`alignment`)

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | åž‹ | å–ã‚Šã†ã‚‹å€¤ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜Ž |
|-----------|-----|-----------|----------|------|
| `horizontal` | `string` | `'left'`, `'center'`, `'right'` | `'left'` | æ°´å¹³æ–¹å‘ã®é…ç½® |
| `vertical` | `string` | `'top'`, `'middle'`, `'bottom'` | `'bottom'` | åž‚ç›´æ–¹å‘ã®é…ç½® |
| `wrapText` | `boolean` | `true` / `false` | `false` | ãƒ†ã‚­ã‚¹ãƒˆã®æŠ˜ã‚Šè¿”ã— |

```typescript
// ä½¿ç”¨ä¾‹
{ alignment: { horizontal: 'center', vertical: 'middle', wrapText: true } }
```

### ç½«ç·šãƒ—ãƒªã‚»ãƒƒãƒˆ

| å€¤ | èª¬æ˜Ž | è¦‹ãŸç›® |
|----|------|--------|
| `'none'` | ç½«ç·šãªã—ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ | ã‚»ãƒ«å¢ƒç•ŒãŒè¦‹ãˆãªã„ |
| `'all'` | ã™ã¹ã¦ã®ã‚»ãƒ«ã«æ ¼å­çŠ¶ã®ç½«ç·š | è¡¨å½¢å¼ |
| `'outer'` | ãƒ‡ãƒ¼ã‚¿é ˜åŸŸã®å¤–æž ã®ã¿ | å¤–å´ã ã‘å›²ã‚€ |
| `'header-body'` | ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã®ä¸‹ã«å¤ªã‚ã®ç·š | ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å¼·èª¿ |

### åˆ—å¹…ã‚ªãƒ—ã‚·ãƒ§ãƒ³

| å€¤ | åž‹ | èª¬æ˜Ž |
|----|-----|------|
| `10`, `20` ãªã© | `number` | å›ºå®šå¹…ï¼ˆæ–‡å­—æ•°ï¼‰ |
| `'auto'` | `string` | ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«åŸºã¥ã„ã¦è‡ªå‹•è¨ˆç®— |
| æœªæŒ‡å®š | - | `autoWidth` è¨­å®šã«å¾“ã†ã€ãªã‘ã‚Œã°ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¹… |

### ã‚¹ã‚¿ã‚¤ãƒ«å„ªå…ˆé †ä½

ã‚¹ã‚¿ã‚¤ãƒ«ã¯ä»¥ä¸‹ã®é †åºã§é©ç”¨ã•ã‚Œã€å¾Œã®ã‚¹ã‚¿ã‚¤ãƒ«ãŒå‰ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä¸Šæ›¸ãã—ã¾ã™ã€‚

**ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ:**
```
styles.all â†’ styles.header â†’ headers[].label.style
```

**ãƒ‡ãƒ¼ã‚¿è¡Œ:**
```
styles.all â†’ styles.body â†’ styles.column[key] â†’ styles.row() â†’ headers[].style â†’ rows[].{key}.style
```

```
å„ªå…ˆåº¦: ä½Ž â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ é«˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚styles.allâ”‚ â†’ â”‚styles.bodyâ”‚ â†’ â”‚styles.column[key]â”‚ â†’ â”‚styles.row()â”‚ â†’ â”‚headers[].styleâ”‚ â†’ â”‚rows[].{key}.styleâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   å…¨ä½“          ãƒœãƒ‡ã‚£å…¨ä½“       åˆ—å…¨ä½“             è¡Œå…¨ä½“          åˆ—å®šç¾©ã®ã‚¹ã‚¿ã‚¤ãƒ«    ã‚»ãƒ«å€‹åˆ¥ã®ã‚¹ã‚¿ã‚¤ãƒ«
```

## APIãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### åŸºæœ¬æ§‹é€ 

```typescript
createWorkbook().addSheet({
  name: string,              // ã‚·ãƒ¼ãƒˆåï¼ˆå¿…é ˆï¼‰
  headers: HeaderDef[],      // åˆ—å®šç¾©ï¼ˆå¿…é ˆï¼‰
  rows: RowData[],           // ãƒ‡ãƒ¼ã‚¿è¡Œï¼ˆå¿…é ˆï¼‰
  title?: TitleConfig,       // ã‚¿ã‚¤ãƒˆãƒ«è¡Œ
  multiRowHeaders?: MultiRowHeaderConfig, // è¤‡æ•°è¡Œãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š
  styles?: StylesConfig,     // å…¨ä½“ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š
  borders?: BorderPreset,    // ç½«ç·šãƒ—ãƒªã‚»ãƒƒãƒˆ
  autoWidth?: AutoWidthConfig // è‡ªå‹•åˆ—å¹…è¨­å®š
})
```

### ãƒ˜ãƒƒãƒ€ãƒ¼å®šç¾© (`HeaderDef`)

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | åž‹ | å¿…é ˆ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜Ž |
|-----------|-----|:----:|----------|------|
| `key` | `string` | âœ… | - | ãƒ‡ãƒ¼ã‚¿ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚­ãƒ¼ |
| `label` | `string \| LabelConfig` | âœ… | - | ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆ |
| `width` | `number \| 'auto'` | - | æœªæŒ‡å®š | åˆ—å¹… |
| `merge` | `'vertical'` | - | æœªæŒ‡å®š | ç¸¦æ–¹å‘ã®è‡ªå‹•çµåˆ |
| `format` | `string \| FormatFn` | - | æœªæŒ‡å®š | è¡¨ç¤ºãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆ |
| `style` | `XLStyle \| StyleFn` | - | æœªæŒ‡å®š | åˆ—ã®ã‚¹ã‚¿ã‚¤ãƒ« |

```typescript
headers: [
  // åŸºæœ¬çš„ãªå®šç¾©
  { key: 'id', label: 'ID', width: 10 },

  // è‡ªå‹•çµåˆ
  { key: 'dept', label: 'éƒ¨ç½²', merge: 'vertical' },

  // ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆæŒ‡å®šï¼ˆExcelå½¢å¼ï¼‰
  { key: 'salary', label: 'çµ¦ä¸Ž', format: 'Â¥#,##0' },

  // ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆæŒ‡å®šï¼ˆé–¢æ•°ï¼‰
  { key: 'rate', label: 'å‰²åˆ', format: (val) => `${val}%` },

  // å›ºå®šã‚¹ã‚¿ã‚¤ãƒ«
  { key: 'total', label: 'åˆè¨ˆ', style: { font: { bold: true } } },

  // æ¡ä»¶ä»˜ãã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆé–¢æ•°ï¼‰
  {
    key: 'status',
    label: 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹',
    style: (val, row, index) => val === 'OK'
      ? { font: { color: '#00AA00' } }
      : { font: { color: '#FF0000' } }
  },

  // ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ãƒ«è‡ªä½“ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
  {
    key: 'name',
    label: { value: 'åå‰', style: { font: { bold: true, color: '#FFFFFF' }, fill: { color: '#4472C4' } } }
  }
]
```

### ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆæ–‡å­—åˆ—

| ç”¨é€” | ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆ | è¡¨ç¤ºä¾‹ |
|------|------------|--------|
| é€šè²¨ï¼ˆãƒ‰ãƒ«ï¼‰ | `'$#,##0'` | $1,000 |
| é€šè²¨ï¼ˆå††ï¼‰ | `'Â¥#,##0'` | Â¥1,000 |
| å°æ•°ç‚¹2æ¡ | `'#,##0.00'` | 1,000.00 |
| ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆ | `'0.00%'` | 12.34% |
| æ—¥ä»˜ | `'yyyy-mm-dd'` | 2025-01-15 |
| æ—¥ä»˜ï¼ˆæ—¥æœ¬å¼ï¼‰ | `'yyyy/mm/dd'` | 2025/01/15 |
| ãƒ†ã‚­ã‚¹ãƒˆï¼ˆæ–‡å­—åˆ—ï¼‰ | `'@'` | ãã®ã¾ã¾è¡¨ç¤º |

### å…ˆé ­ã‚¼ãƒ­ãƒ»æ–‡å­—åˆ—ã®ä¿æŒ

Excelã§ã¯ `01` ã‚„ `007` ã®ã‚ˆã†ãªå€¤ã¯æ•°å€¤ã¨ã—ã¦æ‰±ã‚ã‚Œã€å…ˆé ­ã®ã‚¼ãƒ­ãŒæ¶ˆãˆã¦ã—ã¾ã„ã¾ã™ã€‚
æ–‡å­—åˆ—ã¨ã—ã¦ä¿æŒã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚

**æ–¹æ³•1: ãƒ‡ãƒ¼ã‚¿ã‚’æ–‡å­—åˆ—ã¨ã—ã¦æ¸¡ã™ï¼ˆæŽ¨å¥¨ï¼‰**

```typescript
rows: [
  { code: '007' },      // âœ… æ–‡å­—åˆ—ã¨ã—ã¦æ¸¡ã™ â†’ "007" ã®ã¾ã¾ä¿æŒ
  { code: '0123' },     // âœ… "0123" ã®ã¾ã¾ä¿æŒ
  { zipCode: '00456' }  // âœ… "00456" ã®ã¾ã¾ä¿æŒ
]
```

**æ–¹æ³•2: ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã§ `@` ã‚’æŒ‡å®š**

```typescript
headers: [
  {
    key: 'code',
    label: 'ã‚³ãƒ¼ãƒ‰',
    format: '@'  // ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã‚’å¼·åˆ¶
  }
]
```

**æ³¨æ„ç‚¹:**

| å€¤ | åž‹ | Excelã§ã®è¡¨ç¤º |
|----|-----|--------------|
| `'007'` | æ–‡å­—åˆ— | 007 âœ… |
| `7` | æ•°å€¤ | 7 |
| `'01234567890'` | æ–‡å­—åˆ— | 01234567890 âœ… |
| `1234567890` | æ•°å€¤ | 1234567890 |

> é›»è©±ç•ªå·ã€éƒµä¾¿ç•ªå·ã€ç¤¾å“¡ã‚³ãƒ¼ãƒ‰ãªã©å…ˆé ­ã«ã‚¼ãƒ­ãŒå«ã¾ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ã€å¿…ãšæ–‡å­—åˆ—ã¨ã—ã¦æ¸¡ã—ã¦ãã ã•ã„ã€‚

### ãƒ‡ãƒ¼ã‚¿è¡Œ (`rows`)

```typescript
rows: [
  // ã‚·ãƒ³ãƒ—ãƒ«ãªå€¤
  { id: 1, name: 'Alice', salary: 50000 },

  // ã‚»ãƒ«ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨
  {
    id: 2,
    name: { value: 'Bob', style: { font: { bold: true } } },
    salary: 60000
  }
]
```

### ã‚¿ã‚¤ãƒˆãƒ«è¡Œ (`title`)

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | åž‹ | èª¬æ˜Ž |
|-----------|-----|------|
| `label` | `string \| string[]` | ã‚¿ã‚¤ãƒˆãƒ«ãƒ†ã‚­ã‚¹ãƒˆï¼ˆé…åˆ—ã§è¤‡æ•°è¡Œï¼‰ |
| `style` | `XLStyle` | ã‚¿ã‚¤ãƒˆãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« |

```typescript
// å˜ä¸€è¡Œã‚¿ã‚¤ãƒˆãƒ«
title: {
  label: 'å¾“æ¥­å“¡ãƒªã‚¹ãƒˆ 2025',
  style: {
    fill: { color: '#4472C4' },
    font: { color: '#FFFFFF', bold: true, size: 14 },
    alignment: { horizontal: 'center' }
  }
}

// è¤‡æ•°è¡Œã‚¿ã‚¤ãƒˆãƒ«
title: {
  label: ['æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«', 'æœˆæ¬¡å ±å‘Šæ›¸ 2025å¹´1æœˆ'],
  style: { font: { bold: true }, alignment: { horizontal: 'center' } }
}
```

### å…¨ä½“ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š (`styles`)

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | åž‹ | èª¬æ˜Ž |
|-----------|-----|------|
| `all` | `XLStyle` | å…¨ã‚»ãƒ«ã«é©ç”¨ |
| `header` | `XLStyle` | ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã«é©ç”¨ |
| `body` | `XLStyle` | ãƒ‡ãƒ¼ã‚¿è¡Œå…¨ä½“ã«é©ç”¨ |
| `row` | `(data, index) => XLStyle` | è¡Œã”ã¨ã«å‹•çš„ã‚¹ã‚¿ã‚¤ãƒ« |
| `column` | `{ [key]: XLStyle }` | åˆ—ã”ã¨ã®ã‚¹ã‚¿ã‚¤ãƒ« |

```typescript
styles: {
  all: { font: { name: 'ãƒ¡ã‚¤ãƒªã‚ª', size: 10 } },
  header: { fill: { color: '#4472C4' }, font: { color: '#FFFFFF', bold: true } },
  body: { alignment: { vertical: 'middle' } },
  row: (data, index) => index % 2 === 1 ? { fill: { color: '#F2F2F2' } } : {},
  column: {
    price: { alignment: { horizontal: 'right' } },
    name: { font: { bold: true } }
  }
}
```

### åˆ—å¹…è‡ªå‹•èª¿æ•´ (`autoWidth`)

```typescript
// ã‚·ãƒ³ãƒ—ãƒ«ã«æœ‰åŠ¹åŒ–
autoWidth: true

// è©³ç´°è¨­å®š
autoWidth: {
  enabled: true,           // æœ‰åŠ¹/ç„¡åŠ¹
  padding: 2,              // ä½™ç™½ï¼ˆæ–‡å­—æ•°ï¼‰
  headerIncluded: true,    // ãƒ˜ãƒƒãƒ€ãƒ¼ã‚‚è¨ˆç®—ã«å«ã‚€
  charWidthConstant: 1.2   // å¹…è¨ˆç®—ã®ä¿‚æ•°
}
```

### å‡ºåŠ›ãƒ¡ã‚½ãƒƒãƒ‰

| ãƒ¡ã‚½ãƒƒãƒ‰ | ç’°å¢ƒ | èª¬æ˜Ž |
|---------|------|------|
| `save(filename, options?)` | Node.js | ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ |
| `download(filename, options?)` | ãƒ–ãƒ©ã‚¦ã‚¶ | ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ |
| `saveToBuffer(options?)` | å…±é€š | `Uint8Array` ã‚’å–å¾— |

```typescript
// ã‚ªãƒ—ã‚·ãƒ§ãƒ³
interface SaveOptions {
  timeout?: number;  // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆãƒŸãƒªç§’ï¼‰ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 10000
}

// ä½¿ç”¨ä¾‹
await workbook.save('output.xlsx');
await workbook.save('output.xlsx', { timeout: 30000 });
await workbook.download('output.xlsx');
const buffer = await workbook.saveToBuffer();
```

## è¤‡æ•°è¡Œãƒ˜ãƒƒãƒ€ãƒ¼

è¤‡æ•°è¡Œã«ã¾ãŸãŒã‚‹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å®šç¾©ã§ãã¾ã™ã€‚`colSpan` ã§æ¨ªæ–¹å‘ã€`rowSpan` ã§ç¸¦æ–¹å‘ã«ã‚»ãƒ«ã‚’çµåˆã§ãã¾ã™ã€‚

### åŸºæœ¬çš„ãªä½¿ã„æ–¹

```typescript
await createWorkbook().addSheet({
  name: 'Report',
  headers: [
    { key: 'col1', label: 'Col 1' },
    { key: 'col2', label: 'Col 2' },
    { key: 'col3', label: 'Col 3' }
  ],
  multiRowHeaders: {
    rows: [
      [
        { value: 'Group A', colSpan: 2 },  // 2åˆ—ã‚’æ¨ªã«çµåˆ
        'Group B'
      ],
      ['Sub 1', 'Sub 2', 'Sub 3']  // 2è¡Œç›®
    ]
  },
  rows: [
    { col1: 'A1', col2: 'B1', col3: 'C1' }
  ]
}).save('output.xlsx');
```

**çµæžœ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Group A      â”‚ Group B â”‚  â† 1è¡Œç›®ï¼ˆGroup Aã¯2åˆ—çµåˆï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Sub 1  â”‚ Sub 2  â”‚  Sub 3  â”‚  â† 2è¡Œç›®
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  A1    â”‚  B1    â”‚   C1    â”‚  â† ãƒ‡ãƒ¼ã‚¿è¡Œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### rowSpanï¼ˆç¸¦æ–¹å‘ã®çµåˆï¼‰

```typescript
multiRowHeaders: {
  rows: [
    [
      { value: 'Group 1', colSpan: 2 },
      { value: 'Group 2', rowSpan: 2 }  // 2è¡Œã‚’ç¸¦ã«çµåˆ
    ],
    ['Sub 1', 'Sub 2']  // Group 2ã¯ä¸Šã‹ã‚‰çµåˆã•ã‚Œã¦ã„ã‚‹ã®ã§ã‚¹ã‚­ãƒƒãƒ—
  ]
}
```

**çµæžœ:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Group 1      â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Group 2 â”‚  â† rowSpanã§2è¡Œçµåˆ
â”‚ Sub 1  â”‚ Sub 2  â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ...   â”‚  ...   â”‚   ...   â”‚  â† ãƒ‡ãƒ¼ã‚¿è¡Œ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3è¡Œä»¥ä¸Šã®ãƒ˜ãƒƒãƒ€ãƒ¼

```typescript
multiRowHeaders: {
  rows: [
    [{ value: 'Main Title', colSpan: 4 }],
    [
      { value: 'Left Group', colSpan: 2 },
      { value: 'Right Group', colSpan: 2 }
    ],
    ['A', 'B', 'C', 'D']
  ]
}
```

### ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ãƒ«ã¸ã®ã‚¹ã‚¿ã‚¤ãƒ«é©ç”¨

```typescript
multiRowHeaders: {
  rows: [
    [
      {
        value: 'Styled Header',
        colSpan: 2,
        style: {
          font: { bold: true, color: '#FFFFFF' },
          fill: { color: '#4472C4' },
          alignment: { horizontal: 'center' }
        }
      }
    ],
    ['Column A', 'Column B']
  ]
}
```

### ã‚¿ã‚¤ãƒˆãƒ«ã¨ã®ä½µç”¨

```typescript
{
  title: { label: 'Report Title' },
  multiRowHeaders: {
    rows: [
      [{ value: 'Group', colSpan: 2 }],
      ['A', 'B']
    ]
  },
  // ...
}
// çµæžœ: ã‚¿ã‚¤ãƒˆãƒ«è¡Œ â†’ è¤‡æ•°è¡Œãƒ˜ãƒƒãƒ€ãƒ¼ â†’ ãƒ‡ãƒ¼ã‚¿è¡Œ
```

### HeaderCell ã®åž‹å®šç¾©

| ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ | åž‹ | å¿…é ˆ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜Ž |
|-----------|-----|:----:|----------|------|
| `value` | `string` | âœ… | - | ã‚»ãƒ«ã®ãƒ†ã‚­ã‚¹ãƒˆ |
| `colSpan` | `number` | - | `1` | æ¨ªæ–¹å‘ã®çµåˆæ•° |
| `rowSpan` | `number` | - | `1` | ç¸¦æ–¹å‘ã®çµåˆæ•° |
| `style` | `XLStyle` | - | - | ã‚»ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« |

```typescript
// åž‹å®šç¾©
type HeaderRowDef = (HeaderCell | string)[];  // string ã¯ { value: string } ã®çœç•¥å½¢

interface MultiRowHeaderConfig {
  rows: HeaderRowDef[];
}
```

## ã‚ˆãã‚ã‚‹ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

### äº¤äº’è¡Œã®èƒŒæ™¯è‰²

```typescript
styles: {
  row: (_, index) => index % 2 === 1 ? { fill: { color: '#F2F2F2' } } : {}
}
```

### æ¡ä»¶ä»˜ãæ›¸å¼ï¼ˆå€¤ã«å¿œã˜ãŸè‰²åˆ†ã‘ï¼‰

```typescript
headers: [
  {
    key: 'score',
    label: 'ç‚¹æ•°',
    style: (val) => {
      if (val >= 80) return { font: { color: '#006100' }, fill: { color: '#C6EFCE' } };
      if (val >= 60) return { font: { color: '#9C5700' }, fill: { color: '#FFEB9C' } };
      return { font: { color: '#9C0006' }, fill: { color: '#FFC7CE' } };
    }
  }
]
```

### éƒ¨ç½²ã”ã¨ã«ã‚»ãƒ«ã‚’çµåˆ

```typescript
headers: [
  { key: 'dept', label: 'éƒ¨ç½²', merge: 'vertical', style: { alignment: { vertical: 'middle' } } },
  { key: 'name', label: 'åå‰' },
  { key: 'role', label: 'å½¹è·' }
]
// rows ã¯éƒ¨ç½²ã§ã‚½ãƒ¼ãƒˆã—ã¦ãŠã
```

### é€šè²¨ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã¨å³å¯„ã›

```typescript
headers: [
  {
    key: 'price',
    label: 'ä¾¡æ ¼',
    format: 'Â¥#,##0',
    style: { alignment: { horizontal: 'right' } }
  }
]
```

### ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ç›®ç«‹ãŸã›ã‚‹

```typescript
styles: {
  header: {
    fill: { color: '#4472C4' },
    font: { color: '#FFFFFF', bold: true, size: 12 },
    alignment: { horizontal: 'center' }
  }
}
```

## å®Œå…¨ãªä¾‹

```typescript
import { createWorkbook } from 'xlkit';

await createWorkbook().addSheet({
  name: 'Employees',
  title: {
    label: 'å¾“æ¥­å“¡ãƒªã‚¹ãƒˆ 2025',
    style: {
      fill: { color: '#1F4E79' },
      font: { color: '#FFFFFF', bold: true, size: 16 },
      alignment: { horizontal: 'center' }
    }
  },
  headers: [
    {
      key: 'dept',
      label: 'éƒ¨ç½²',
      merge: 'vertical',
      style: { alignment: { vertical: 'middle', horizontal: 'center' } }
    },
    { key: 'name', label: 'åå‰', width: 20 },
    {
      key: 'salary',
      label: 'çµ¦ä¸Ž',
      format: 'Â¥#,##0',
      style: (val) => val > 100000
        ? { font: { color: '#006100', bold: true }, fill: { color: '#C6EFCE' } }
        : {}
    },
    {
      key: 'status',
      label: 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹',
      format: (val) => val ? 'åœ¨ç±' : 'é€€è·',
      style: (val) => ({ font: { color: val ? '#006100' : '#9C0006' } })
    }
  ],
  rows: [
    { dept: 'Engineering', name: 'Alice', salary: 120000, status: true },
    { dept: 'Engineering', name: 'Bob', salary: 80000, status: true },
    { dept: 'Sales', name: 'Charlie', salary: 95000, status: true },
    { dept: 'Sales', name: 'Diana', salary: 88000, status: false }
  ],
  styles: {
    all: { font: { name: 'ãƒ¡ã‚¤ãƒªã‚ª', size: 10 } },
    header: { fill: { color: '#4472C4' }, font: { color: '#FFFFFF', bold: true } },
    row: (_, index) => index % 2 === 1 ? { fill: { color: '#F2F2F2' } } : {}
  },
  borders: 'all',
  autoWidth: true
}).save('employees.xlsx');
```

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT
