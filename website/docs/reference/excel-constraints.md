---
sidebar_position: 3
---

# Excel制約

xlmakeはExcelの仕様に基づく制約を自動でチェックし、違反時はエラーをスローします。

## 制約一覧

| 項目 | 制約 |
|------|------|
| シート名 | 最大31文字 |
| シート名禁止文字 | `: \ / ? * [ ]` |
| 最大行数 | 1,048,576行 |
| 最大列数 | 16,384列（XFD列） |

## シート名の制約

### 文字数制限

シート名は最大31文字までです。

```typescript
// OK
xlmake().sheet("売上データ2024年1月分")  // 14文字

// NG: エラーがスローされる
xlmake().sheet("これは31文字を超える非常に長いシート名です")
```

### 禁止文字

以下の文字はシート名に使用できません:

- `:` (コロン)
- `\` (バックスラッシュ)
- `/` (スラッシュ)
- `?` (クエスチョンマーク)
- `*` (アスタリスク)
- `[` (左角括弧)
- `]` (右角括弧)

```typescript
// NG: エラーがスローされる
xlmake().sheet("売上/在庫")    // スラッシュを含む
xlmake().sheet("データ[2024]") // 角括弧を含む
```

## 行数・列数の制約

Excelの最大行数は1,048,576行、最大列数は16,384列（XFD列）です。

xlmakeはこれらの制約を自動でチェックし、超過した場合はエラーをスローします。

## エラーハンドリング

制約違反時はエラーがスローされるため、try-catchで処理できます。

```typescript
try {
  const output = await xlmake()
    .sheet("これは31文字を超える非常に長いシート名です")
    .table({ ... })
    .getNode();
} catch (error) {
  console.error("Excel制約違反:", error.message);
}
```

## 関連

- [複数シート](../guides/multi-sheet.md) - 複数シートの作成方法
- [サポートしていない機能](./limitations.md) - xlmakeの制限事項
